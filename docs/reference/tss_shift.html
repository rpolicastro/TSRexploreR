<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>TSS Shifting — tss_shift • TSRexploreR</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="TSS Shifting — tss_shift" />
<meta property="og:description" content="Analyze TSS shifts between samples within a consensus TSR set." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">TSRexploreR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/BAM_PROCESSING.html">BAM Processing</a>
    </li>
    <li>
      <a href="../articles/DATA_CONDITIONING.html">Data Conditioning</a>
    </li>
    <li>
      <a href="../articles/DIFF_FEATURES.html">Differential Feature Analysis</a>
    </li>
    <li>
      <a href="../articles/FEATURE_SHIFT.html">TSS Shifting</a>
    </li>
    <li>
      <a href="../articles/STANDARD_ANALYSIS.html">Standard Analysis</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>TSS Shifting</h1>
    
    <div class="hidden name"><code>tss_shift.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Analyze TSS shifts between samples within a consensus TSR set.</p>
    </div>

    <pre class="usage"><span class='fu'>tss_shift</span><span class='op'>(</span>
  <span class='va'>experiment</span>,
  <span class='va'>sample_1</span>,
  <span class='va'>sample_2</span>,
  <span class='va'>comparison_name</span>,
  tss_threshold <span class='op'>=</span> <span class='cn'>NULL</span>,
  max_distance <span class='op'>=</span> <span class='fl'>100</span>,
  min_threshold <span class='op'>=</span> <span class='fl'>10</span>,
  n_resamples <span class='op'>=</span> <span class='fl'>1000L</span>,
  fdr_cutoff <span class='op'>=</span> <span class='fl'>0.05</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>experiment</th>
      <td><p>TSRexploreR object.</p></td>
    </tr>
    <tr>
      <th>sample_1</th>
      <td><p>First sample to compare.
Vector with sample names for TSSs and TSRs,
with names 'TSS' and 'TSR'.</p></td>
    </tr>
    <tr>
      <th>sample_2</th>
      <td><p>Second sample to compare.
Vector with sample name for TSSs and TSRs,
with names 'TSS' and 'TSR'.</p></td>
    </tr>
    <tr>
      <th>comparison_name</th>
      <td><p>Name assigned to the results in the TSRexploreR object.</p></td>
    </tr>
    <tr>
      <th>tss_threshold</th>
      <td><p>Minimum number of raw counts required at a TSS for it to
be considered in the shifting analysis.</p></td>
    </tr>
    <tr>
      <th>max_distance</th>
      <td><p>TSRs less than this distance apart will be merged.</p></td>
    </tr>
    <tr>
      <th>min_threshold</th>
      <td><p>Minimum number of raw counts required in each TSR for both samples.</p></td>
    </tr>
    <tr>
      <th>n_resamples</th>
      <td><p>Number of resamplings for permutation test.</p></td>
    </tr>
    <tr>
      <th>fdr_cutoff</th>
      <td><p>Differential features not meeting this significance threshold will not be considered.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>TSRexploreR object with shifting scores added.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function assesses the difference between TSS distributions from two distinct samples
in a set of consensus TSRs by calculating a signed version of the earth mover's distance (EMD)
that we term earth mover's score (EMS). For this approach, we imagine that the two TSS 
distributions in questions are piles of dirt, and ask how much dirt from one pile we would 
need to move, how far, and in which direction, to mimic the distribution of the other sample.
The resulting EMS is between -1 and 1, with larger magnitudes indicating larger shifts and 
the sign indicating direction (negative values indicate upstream shifts and positive values 
indicate downstream shifts). The positive and negative components of the EMS are also reported.
Lastly, the function calculates a p-value for the null hypothesis that there is no difference 
between the two samples using a permutation test and an FDR-corrected p-value calculated by the 
Benjamini-Hochberg procedure.</p>
<p>This function also calculates unsigned EMD, which indicates how much TSS "mass" has been moved 
between two distributions without regard to direction. This is useful in the detection of "balanced" 
shifts, wherein approximately equal mass is moved upstream and downstream. Examples of this are 
TSR splitting or merging and a change in TSR shape (e.g., peaked to broad). These will generally 
be marked by a low EMS, balanced positive and negative scores, and a high EMD. As for EMS, raw and 
FDR-corrected p-values are reported for EMD.</p>
<p>'sample_1' and 'sample_2' should be the names of the two samples to compare. 'sample_1' should 
be the control and 'sample_2' the treatment sample.
The results will be stored back in the TSRexploreR object with the name given by
  'comparison_name'.
'tss_threshold' applies a global threshold to remove TSSs below a certain score,
  and 'min_threshold' is the minimal score that both TSRs must have to be considered.
'max_distance' is the maximum distance between two two TSRs to be considered for shifting.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>TSSs</span><span class='op'>)</span>
<span class='va'>assembly</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"extdata"</span>, <span class='st'>"S288C_Assembly.fasta"</span>, package <span class='op'>=</span> <span class='st'>"TSRexploreR"</span><span class='op'>)</span>
<span class='va'>samples</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>
  sample_name<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/sprintf.html'>sprintf</a></span><span class='op'>(</span><span class='st'>"S288C_D_%s"</span>, <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span><span class='op'>(</span><span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/sprintf.html'>sprintf</a></span><span class='op'>(</span><span class='st'>"S288C_WT_%s"</span>, <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span><span class='op'>(</span><span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>,
  file_1<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='cn'>NA</span>, <span class='fl'>6</span><span class='op'>)</span>, file_2<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='cn'>NA</span>, <span class='fl'>6</span><span class='op'>)</span>,
  condition<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>"Diamide"</span>, <span class='fl'>3</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>"Untreated"</span>, <span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>)</span>

<span class='va'>exp</span> <span class='op'>&lt;-</span> <span class='va'>TSSs</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='tsr_explorer-class.html'>tsr_explorer</a></span><span class='op'>(</span>sample_sheet<span class='op'>=</span><span class='va'>samples</span>, genome_assembly<span class='op'>=</span><span class='va'>assembly</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='format_counts.html'>format_counts</a></span><span class='op'>(</span>data_type<span class='op'>=</span><span class='st'>"tss"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='tss_clustering.html'>tss_clustering</a></span><span class='op'>(</span>threshold<span class='op'>=</span><span class='fl'>3</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='merge_samples.html'>merge_samples</a></span><span class='op'>(</span>data_type <span class='op'>=</span> <span class='st'>"tss"</span>, merge_group<span class='op'>=</span><span class='st'>"condition"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='merge_samples.html'>merge_samples</a></span><span class='op'>(</span>data_type <span class='op'>=</span> <span class='st'>"tsr"</span>, merge_group<span class='op'>=</span><span class='st'>"condition"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: Arguments in '...' ignored</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Arguments in '...' ignored</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Arguments in '...' ignored</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Arguments in '...' ignored</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Arguments in '...' ignored</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Arguments in '...' ignored</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Arguments in '...' ignored</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Arguments in '...' ignored</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Arguments in '...' ignored</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Arguments in '...' ignored</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Arguments in '...' ignored</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Arguments in '...' ignored</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Arguments in '...' ignored</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Arguments in '...' ignored</span></div><div class='input'>
<span class='va'>exp</span> <span class='op'>&lt;-</span> <span class='fu'>tss_shift</span><span class='op'>(</span>
  <span class='va'>exp</span>,
  sample_1<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>TSS<span class='op'>=</span><span class='st'>"S288C_WT_1"</span>, TSR<span class='op'>=</span><span class='st'>"S288C_WT_1"</span><span class='op'>)</span>,
  sample_2<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>TSS<span class='op'>=</span><span class='st'>"S288C_D_1"</span>, TSR<span class='op'>=</span><span class='st'>"S288C_D_1"</span><span class='op'>)</span>,
  comparison_name<span class='op'>=</span><span class='st'>"Untreated_vs_Diamide"</span>,
  max_distance <span class='op'>=</span> <span class='fl'>100</span>, min_threshold <span class='op'>=</span> <span class='fl'>10</span>, n_resamples <span class='op'>=</span> <span class='fl'>1000L</span>
<span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: Arguments in '...' ignored</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Some sequences have fewer than nthresh scores for at least one sample. </span>
#&gt; <span class='warning'>            These are ignored and returned as NA.</span></div><div class='output co'>#&gt; <span class='message'>Joining, by = c("fhash", "sample_indicator")</span></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Robert Policastro.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


